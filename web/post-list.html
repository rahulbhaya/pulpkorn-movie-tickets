<link rel="import" href="bower_components/polymer/polymer.html">
<link rel="import" href="post-service/post-service.html">
<link rel="import" href="post-card.html">

<polymer-element name="post-list" attributes="show">
    <template>
        <style>
            :host {
                display: block;
                width: 100%;
            }

            post-card {
            }
        </style>
        <style>
            .h2 {
                margin-top: -10px;
                font-size: 1.6rem;
                font-weight: 300;
            }
        </style>

        <post-service id="service" posts="{{posts}}"></post-service>

        <div horizontal layout wrap center-justified>
            <template repeat="{{post in posts}}">
                <post-card favorite="{{post.favorite}}"
                           on-favorite-tap="{{handleFavorite}}"
                           hidden?="{{show == 'favorites' && !post.favorite}}">
                    <img src="{{post.avatar}}">
                    <video id="{{post.video_id}}" controls width="100%" style="display: {{post.video_display}}" ;><source src="{{post.video}}" type="video/mp4"></video>
                    <div style="background-color:white;padding-bottom: 10px;box-shadow: 3px 3px 3px #d3d1d1;">
                        <div class="h2" style="max-width: 300px;margin-left: auto;margin-right: auto;padding-left: 10px;  padding-right: 10px;">{{post.username}}</div>
                        <p style="max-width: 300px;margin-left: auto;margin-right: auto;line-height: 1.6;padding-left: 10px;  padding-right: 10px;">{{post.text}}</p>
                    </div>
                </post-card>
            </template>
        </div>
    </template>

    <script>
        Polymer({
            handleFavorite: function (event, detail, sender) {
                var post = sender.templateInstance.model.post;
                this.$.service.setFavorite(post.uid, post.favorite);
            }
        });
    </script>
</polymer-element>
